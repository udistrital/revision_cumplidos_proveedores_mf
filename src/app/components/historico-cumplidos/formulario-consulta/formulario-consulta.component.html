<main>
  <article>
    <mat-card class="historicoss-cumplido">
      <section class="title">
        <mat-card-header>
          <mat-card-title>
            <div class="title-border">{{ title }}</div>
          </mat-card-title>
        </mat-card-header>
      </section>

      <section>
        <mat-card-content>
          <mat-card class="margin-form">
            <form (ngSubmit)="consultar()" [formGroup]="formularioFiltroHistorico">

              <div class="">
                <mat-form-field appearance="outline">
                  <mat-label class="label">Seleccione Dependencia</mat-label>
                  <mat-select placeholder="Dependencia" formControlName="dependencias" multiple (selectionChange)="dependenciaChange($event.value)">
                    <mat-form-field>
                      <input matInput style="display:flex; justify-content:center; font-size:large;" placeholder="Filtrar Dependencias" (keyup)="filtrarDependencias($event)" (keydown)="preventSpaceKey($event)">
                    </mat-form-field>
                    <mat-option *ngFor="let dependencia of dependenciasSeleccionadas" [value]="dependencia">
                      {{dependencia.Nombre}}
                    </mat-option>
                  </mat-select>
                  <mat-error *ngIf="formularioFiltroHistorico.get('dependencias')?.invalid" class="label-error">
                    Selecciona una dependencia.
                  </mat-error>
                </mat-form-field>
              </div>

              <div class="">
                <mat-form-field appearance="outline">
                  <mat-label class="label">Seleccione un número de contrato</mat-label>
                  <mat-select placeholder="Número de contrato" formControlName="numeros_contrato" multiple (selectionChange)="contratoChange($event.value)">
                    <mat-form-field>
                      <input matInput style="display:flex; justify-content:center; font-size:large;" placeholder="Filtrar Contratos" (keyup)="filtrarContratos($event)" (keydown)="preventSpaceKey($event)">
                    </mat-form-field>
                    <mat-option *ngFor="let contrato of contratosFiltrados" [value]="contrato">
                      {{contrato.contrato}}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>

              <div class="">
                <mat-form-field appearance="outline">
                  <mat-label class="label">Seleccione vigencia</mat-label>
                  <mat-select placeholder="Vigencia" formControlName="vigencias" multiple>
                    <mat-form-field>
                      <input matInput style="display:flex; justify-content:center; font-size:large;" placeholder="Filtrar Vigencias" (keyup)="filtrarVigencias($event)" (keydown)="preventSpaceKey($event)">
                    </mat-form-field>
                    <mat-option *ngFor="let vigencia of vigenciasFiltradas" [value]="vigencia">
                      {{ vigencia }}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>

              <div class="">
                <mat-form-field appearance="outline">
                  <mat-label class="label">Proveedor</mat-label>
                  <mat-select formControlName="nombres_proveedor" multiple>
                    <mat-form-field>
                      <input matInput style="display:flex; justify-content:center; font-size:large;" placeholder="Filtrar Proveedores" (keyup)="filtrarProveedores($event)" (keydown)="preventSpaceKey($event)">
                    </mat-form-field>
                    <mat-option *ngFor="let proveedor of proveedoresFiltrados" [value]= "proveedor.ProveedorId">
                      {{proveedor.Nit +" - " +proveedor.NombreProveedor }}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>

              <div class="">
                <mat-form-field appearance="outline">
                  <mat-label class="label">Seleccione año</mat-label>
                  <mat-select formControlName="anios" placeholder="Año" multiple>
                    <mat-form-field>
                      <input matInput style="display:flex; justify-content:center; font-size:large;" placeholder="Filtrar Años" (keyup)="filtrarAnios($event)" (keydown)="preventSpaceKey($event)">
                    </mat-form-field>
                    <mat-option *ngFor="let anio of aniosFiltrados" [value]="anio">
                      {{ anio }}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>

              <div class="">
                <mat-form-field appearance="outline">
                  <mat-label class="label">Seleccione mes</mat-label>
                  <mat-select placeholder="Mes" formControlName="meses" multiple>
                    <mat-form-field>
                      <input matInput style="display:flex; justify-content:center; font-size:large;" placeholder="Filtrar Meses" (keyup)="filtrarMeses($event)" (keydown)="preventSpaceKey($event)">
                    </mat-form-field>
                    <mat-option *ngFor="let mes of mesesFiltrados" [value]="mes.mes">
                      {{ mes.nombre }}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>

              <div class="">
                <mat-form-field appearance="outline">
                  <mat-label>Seleccione estado</mat-label>
                  <mat-select class="label" placeholder="Estado" formControlName="estados" multiple>
                    <mat-form-field>
                      <input matInput style="display:flex; justify-content:center; font-size:large;" placeholder="Filtrar Estados" (keyup)="filtrarEstados($event)" (keydown)="preventSpaceKey($event)">
                    </mat-form-field>
                    <mat-option *ngFor="let estado of estadosFiltrados" [value]="estado.CodigoAbreviacion">
                      {{estado.Nombre}}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>

              <div class="btn-container">
                <button mat-raised-button class="btn-success">Consultar</button>
              </div>
            </form>
          </mat-card>
        </mat-card-content>
      </section>
    </mat-card>
  </article>
</main>
